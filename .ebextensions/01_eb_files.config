packages:
    yum:
        nfs-utils: []
        ruby-devel: []
        rubygems: []
files:
  "/opt/elasticbeanstalk/hooks/appdeploy/pre/01a_set_up_token.sh" :
    mode: "000755"
    owner: root
    group: root
    content: |
      #!/usr/bin/env bash
      EB_APP_DEPLOY_DIR=$(/opt/elasticbeanstalk/bin/get-config container -k app_deploy_dir)
      DEPLOYMENT_TOKEN=$(/opt/elasticbeanstalk/bin/get-config environment -k DEPLOYMENT_TOKEN)
      touch "$EB_APP_DEPLOY_DIR/.deployment_token"
      echo $DEPLOYMENT_TOKEN > "$EB_APP_DEPLOY_DIR/.deployment_token"

  "/opt/elasticbeanstalk/hooks/appdeploy/pre/01a_set_up_efs.sh" :
    mode: "000755"
    owner: root
    group: root
    content: |
      #!/usr/bin/env bash
      mkdir ~/efs-mount-point
      mount -t nfs4 -o nfsvers=4.1 $(curl -s http://169.254.169.254/latest/meta-data/placement/availability-zone).fs-d3db2f7a.efs.us-west-2.amazonaws.com:/   ~/efs-mount-point

